<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>JavaScript面向对象编程实践</title>
    <meta name="description" content="">
    <!--<link rel="stylesheet" href="/assets/css/bootstrap.min.css">-->
    <!--<link rel="stylesheet" href="/assets/css/font-awesome.min.css">-->
    <link rel="icon" type="image/png" href="/favicon.ico">
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://fonts.useso.com/css?family=Roboto">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/syntax-highlight.css">
    
    <link rel="stylesheet" href="/assets/css/proj-layout.css">
    <script src="/assets/js/swiftype.js"></script>
    <!--<script src="/assets/js/jquery.js"></script>-->
    <!--<script src="/assets/js/modernizr.min.js"></script>-->
    <!--<script src="/assets/js/bootstrap.min.js"></script>-->
</head>

<body>
    <header>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <p class="site-name"><a class="navbar-brand" href="/" title="twolun">双轮行</a></p>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/">HOME</a></li>
                    <li><a href="/about.html">About</a></li>
                    <li><a href="/project.html">Projects</a></li>
                    <li><a href="/list.html">Posts</a></li>
                    <li><a href="http://wwsun.lofter.com/" target="_blank">Lofter</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- .site-navigation -->
</header>
    <div id="post-content" class="container">
        <br>
        <div class="well">
            <header class="page-header">
                <h1>JavaScript面向对象编程实践</h1>
                <p class="post-meta">Apr 10, 2016</p>
            </header>
            <article><p>写本文的初衷是基于不久前写的一篇<a href="http://wwsun.github.io/posts/javascript-oo-summary.html">JavaScript面向对象深入解读</a>这篇博文，
因此在此基础上谈一谈如何具体的使用面向对象的方式进行前端开发。随着认识的深入，将会形成一个系列，综述前端开发方式这些年来的变化。
本文通过面向对象的方式来解释组件开发的过程，我们将会以选项卡组件开发为例。向你介绍如何从零开始使用面向对象的方式开发前端组件。</p>

<!--more-->

<p>本文项目的源代码存放在<a href="https://github.com/wwsun/component-tab">Github仓库</a>中。</p>

<h2 id="section">从0到1</h2>

<p>假设我们想创建一个Tab多选项卡组件，用于切换选择不同的内容。</p>

<p>初始的HTML结构如下：</p>

<p>```html</p>
<div class="tab">
    <ul class="tab-menuWrapper">
        <li class="tab-menu">menu1</li>
        <li class="tab-menu">menu2</li>
        <li class="tab-menu">menu3</li>
        <li class="tab-menu">menu4</li>
    </ul>

    <div class="tab-contentWrapper">
        <div class="tab-content">content1</div>
        <div class="tab-content" style="display: none;">content2</div>
        <div class="tab-content" style="display: none;">content3</div>
        <div class="tab-content" style="display: none;">content4</div>
    </div>
</div>
<p>```</p>

<p>初始的样式代码如下：</p>

<p>```css
ul {
    padding: 0;
    margin: 0;
}</p>

<p>.tab {
    width: 400px;
}</p>

<p>.tab-menuWrapper {
    padding-left: 20px;
}</p>

<p>.tab-menuWrapper li {
    float: left;
    display: inline;
    padding: 5px;
    border: 1px solid #333;
    border-bottom: none;
    margin-right: 5px;
    cursor: pointer;
}</p>

<p>.tab-contentWrapper {
    border: 1px solid #333;
    clear: left;
    padding: 5px;
}
```</p>

<p>我们需要使用面向对象的方式来实现Tab组件的展示和交互逻辑。</p>

<p>利用构造函数，我们编写<code class="highlighter-rouge">Tab</code>构造函数：</p>

<p>```javascript
function Tab(config) {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>this._root = config.root;
var trigger = config.trigger || 'click';

this._tabMenus = this._root.getElementsByClassName('tab-menu');
this._tabContents = this._root.getElementsByClassName('tab-content');

var self = this;

var i,
    n;
for (i = 0, n = this._tabMenus.length; i &lt; n; i++) {
    this._tabMenus[i]._index = i;
    setEvent(this._tabMenus[i], trigger, function () {
        self.showItem(this._index);
    });
} } ```
</code></pre>
</div>

<p>其中<code class="highlighter-rouge">showItem(n)</code>方法用于显示目标文本框。实现如下</p>

<p>```javascript
Tab.prototype.showItem = function (n) {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var i;
for (i = 0; i &lt; this._tabContents.length; i++) {
    this._tabContents[i].style.display = 'none';
}
this._tabContents[n].style.display = 'block';
</code></pre>
</div>

<p>};
```</p>

<p><code class="highlighter-rouge">setEvent</code>方法用于事件绑定：</p>

<p>```javascript
var setEvent = function (node, eventType, handler, scope) {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node = typeof node === 'string' ? document.getElementById(node) : node;
scope = scope || node;

node.addEventListener(eventType, function () {
    handler.apply(scope, arguments);
});
</code></pre>
</div>

<p>};
```</p>

<p>最后让Tab组件工作：</p>

<p>```javascript
var tabs = document.getElementsByClassName(‘tab’);</p>

<p>new Tab({
    root: tabs[0]
});
```</p>

<h2 id="section-1">完善</h2>

<p>我们想要高亮当前到选项卡。</p>

<p>我们首先增加一个<code class="highlighter-rouge">.ative</code>样式，用于修改激活选项卡的样式。</p>

<p><code class="highlighter-rouge">css
.active {
    color: white;
    background: green;
}
</code></p>

<p>完善Tab组件：</p>

<p>```javascript
Tab.prototype.showItem = function (n) {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var i;
for (i = 0; i &lt; this._tabContents.length; i++) {
    this._tabContents[i].style.display = 'none';
}
this._tabContents[n].style.display = 'block';

if (this._currentClass) {
    var currentMenu = this._root.getElementsByClassName(this._currentClass)[0];
    if (currentMenu) {
        removeClass(currentMenu, this._currentClass);
    }
    addClass(this._tabMenus[n], this._currentClass);
}
</code></pre>
</div>

<p>};
```</p>

<p>我们增加了<code class="highlighter-rouge">removeClass</code>和<code class="highlighter-rouge">addClass</code>两个辅助方法，分别用于给指定的dom节点删除和增加样式。</p>

<p>使用方法上，我们增加了一个<code class="highlighter-rouge">currentClass</code>来供用户自定义激活选项卡的样式。</p>

<p><code class="highlighter-rouge">javascript
new Tab({
    root: tabs[1],
    currentClass: 'active'
});
</code></p>
</article>
        </div>
    </div><!--#post-content-->

    <div id="ds-comment" class="container">
        <div class="ds-thread" data-thread-key="/posts/javascript-oo-tutorial.html" data-title="JavaScript面向对象编程实践"></div>
        <script>
            var duoshuoQuery = {short_name:"wwsun"};  
            (function() {  
                var ds = document.createElement('script');  
                ds.type = 'text/javascript';
                ds.async = true;  
                ds.src = 'http://static.duoshuo.com/embed.js';  
                ds.charset = 'UTF-8';  
                (document.getElementsByTagName('head')[0]
                || document.getElementsByTagName('body')[0]).appendChild(ds);  
            })();
        </script>
    </div><!--#ds-comment-->

    <footer id="colophon" class="site-footer" role="contentinfo">
    <div class="site-info container">
        <div class="row">
            <nav id="menu-social" class="social-icons">
                <ul id="menu-social-items" class="social-menu">
                    <li><a href="https://github.com/wwsun" title="Github" class="rss" target="_blank"><i class="social_icon fa fa-github"><span>Github</span></i></a></li>
                    <li><a href="http://weibo.com/234170023" title="Weibo" class="youtube" target="_blank"><i class="social_icon fa fa-weibo"><span>Weibo</span></i></a></li>
                    <li><a href="https://twitter.com/wsun38" title="Twitter" class="twitter" target="_blank"><i class="social_icon fa fa-twitter"><span>Twitter</span></i></a></li>
                    <li><a href="https://plus.google.com/u/0/101153267739962807712/posts" title="Google+" class="googleplus" target="_blank"><i class="social_icon fa fa-googleplus"><span>GooglePlus</span></i></a></li>
                    <li><a href="/about.html#wechatQr" title="Wechat" class="facebook" target="_blank"><i class="fa fa-weixin"><span>Wechat</span></i></a></li>
                </ul>
            </nav>
            <nav role="navigation" class="col-md-6">
                <ul id="menu-flat-footer" class="nav footer-nav clearfix">
                    <li><a href="http://weibo.com/swwol">Weibo</a></li>
                    <li><a href="https://github.com/wwsun">Github</a></li>
                    <li><a href="http://www.zhihu.com/people/wwsun">Zhihu</a></li>
                    <li><a href="http://www.youtube.com/user/bootstrapbayofficial">Lofter</a></li>
                    <li><a href="http://wwsun.github.io/">Blog</a></li>
                </ul>
            </nav>
            <div class="copyright col-md-6">
                <a href="http://wwsun.github.io/" title="Sparkling">Weiwei SUN</a> All rights reserved. Theme by 
                <a href="http://colorlib.com/" target="_blank">Colorlib</a> Powered by
                <a href="https://pages.github.com/" target="_blank">Github Pages</a> and <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
            </div>
        </div>
    </div>
    <!-- .site-info -->
    <div class="scroll-to-top"><i class="fa fa-angle-up"></i></div>
    <!-- .scroll-to-top -->
</footer><!-- #colophon -->

<!-- Google Tag Manager -->
<noscript>
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-KJHNXB" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KJHNXB');
</script>
<!-- End Google Tag Manager -->

</body>

</html>