<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Jersey2.11 快速入门指南</title>
    <meta name="description" content="">
    <!--<link rel="stylesheet" href="/assets/css/bootstrap.min.css">-->
    <!--<link rel="stylesheet" href="/assets/css/font-awesome.min.css">-->
    <link rel="icon" type="image/png" href="/favicon.ico">
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://fonts.useso.com/css?family=Roboto">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/syntax-highlight.css">
    
    <link rel="stylesheet" href="/assets/css/proj-layout.css">
    <script src="/assets/js/swiftype.js"></script>
    <!--<script src="/assets/js/jquery.js"></script>-->
    <!--<script src="/assets/js/modernizr.min.js"></script>-->
    <!--<script src="/assets/js/bootstrap.min.js"></script>-->
</head>

<body>
    <header>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <p class="site-name"><a class="navbar-brand" href="/" title="twolun">双轮行</a></p>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/">HOME</a></li>
                    <li><a href="/about.html">About</a></li>
                    <li><a href="/project.html">Projects</a></li>
                    <li><a href="/list.html">Posts</a></li>
                    <li><a href="http://wwsun.lofter.com/" target="_blank">Lofter</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- .site-navigation -->
</header>
    <div id="post-content" class="container">
        <br>
        <div class="well">
            <header class="page-header">
                <h1>Jersey2.11 快速入门指南</h1>
                <p class="post-meta">Aug 3, 2014</p>
            </header>
            <article><p>前面我们提到了REST, 该概念在2000年由Roy Fielding在博士论文中提出。但是，对Java而言，直到2008年JSR 311(JAX-RS: Java Api for RESTful Web Services)规范定稿才将其标准化。Jersey是JSR 311的参考实现，本文将介绍Jersey2.11的必要API和注释，使用Netbeans 8.0 for Java EE作为IDE。
<!--more-->
###RESTful Web Service
REST中最重要的概念是资源，使用URI作为标识。客户端通过HTTP的GET\POST\DELETE\PUT方法操作资源或资源集。RESTful Web Service即使用HTTP和REST原理实现的Web服务。其特点如下：</p>

<ul>
  <li>使用URI</li>
  <li>支持MIME类型的响应数据，包括JSON/XML/JPEG等</li>
  <li>使用HTTP GET/POST/DELETE/PUT（对应查找、新增、删除、修改）</li>
</ul>

<h3 id="jsr-311jax-rsjersey">JSR 311(JAX-RS)和Jersey</h3>
<p>Jersey是JSR 311的Java实现，可以快速的实现RESTful Web Service。Jersey的最新版本为2.6。其主要包含三个部分：</p>

<ul>
  <li>核心服务器（Core Server）：通过提供JSR 311 中标准化的注释和API 标准化，您可以用直观的方式开发RESTful Web 服务</li>
  <li>核心客户端（Core Client）：Jersey 客户端API 帮助您与REST 服务轻松通信。</li>
  <li>集成（Integration）：Jersey 还提供可以轻松集成Spring、Guice、Apache Abdera 的库。</li>
</ul>

<p>Jersey项目地址：
<a href="https://jersey.java.net/">https://jersey.java.net/</a></p>

<p>Jersey文档地址：
<a href="https://jersey.java.net/documentation/latest/index.html">https://jersey.java.net/documentation/latest/index.html</a></p>

<p>使用Jersey需要考虑如下依赖关系(下面的包都省略的版本，下载最新的版本即可)：</p>

<ul>
  <li>commons-beanutils.jar</li>
  <li>commons-lang.jar</li>
  <li>commons-logging.jar</li>
  <li>ezmorph-1.0.2.jar</li>
  <li>javax.servlet.api.jar</li>
  <li>javax.ws.rs-api</li>
  <li>json-lib.jar</li>
</ul>

<h3 id="restful-web-service">RESTful Web Service开发流程</h3>
<p>使用Netbeans可以快速的以数据库为基础（或什么都没有）构建RESTful web service, 具体可以参考Neanbenas的一篇文档：
<a href="https://netbeans.org/kb/docs/websvc/rest.html">https://netbeans.org/kb/docs/websvc/rest.html</a></p>

<p>这边生成的文件如下：
假设我们的数据库中有一个movie表，这里会对应生成JPA风格的entity类，并为该类生成相应的REST服务类。如下：</p>

<ul>
  <li>AbstractFacade.java 抽象基类（无需改动）</li>
  <li>ApplicationConfig.java 配置类（无需改动）</li>
  <li>MovieFacadeREST.java Movie类对应的REST类（根据需求修改该类）</li>
</ul>

<p>测试成功后，我们即创建了RESTful风格的Web Service。下面我们要做的是利用Jersey生成消费该Web Service应用。具体步骤如下：</p>

<ul>
  <li>创建一个新的web application</li>
  <li>新建Restful Java Client (这里即使用了Jersey来生成消费服务)</li>
  <li>加入所有依赖的jar包。</li>
</ul>

<h3 id="jersey-23-api">Jersey 2.3 API文档核心内容</h3>
<p>####常用注释：（对应文档的ch3）</p>

<ul>
  <li>@Path 定义资源的相对URI</li>
  <li>@GET 意味着以下方法可以响应HTTP GET方法</li>
  <li>@Produces 响应的MIME类型</li>
</ul>

<p>例子如下：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@PUT
@Path("{id}")
@Consumes({"application/xml", "application/json"})
public void edit(@PathParam("id") String id, Movie entity) {
    super.edit(entity);
}
</code></pre>
</div>

<p>@Path的具体解释如下：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Path("/users/{username}")
</code></pre>
</div>

<p>这个例子中，{username}即为用户输入的数据，例如用户输入Weiwei，则URL定位到 http://example.com/users/Weiwei</p>

<p>在@Path中也可以使用正则表达式，默认的正则为 “[^/]+?”, 你可以通过如下方式添加正则表达式，以限制用户的的输入：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Path("users/{username: [a-zA-Z][a-zA-Z_0-9]*}")
</code></pre>
</div>

<p>@Produce的具体解释如下：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Produces("text/plain")
</code></pre>
</div>

<p>指定了资源所产生和发送给客户端的MIME类型，这里指定了类型为纯文本类型。</p>

<p>@Consume的具体解释如下：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Consumes({"application/xml", "application/json"})
</code></pre>
</div>

<p>指定所消费的类型的格式，这里指定为XML和JSON，即可以接收这种类型格式的文件作为输入。</p>

<p>参数注解：</p>

<p>@*Param，这里主要介绍@PathParam, 即对应上面定义的路径的参数。其他类型的注解参见API文档，这里只是简单介绍下常用的注解。</p>

<h4 id="apiapich5">客户端API（对应API的ch5）</h4>
<p>这里主要是为了读懂客户端生成的JerseyClient类中的代码。该类中的代码与Web Service中的代码是对应的。可以从一个简单的例子开始：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public NewJerseyClient() {
    client = javax.ws.rs.client.ClientBuilder.newClient();
    webTarget = client.target(BASE_URI).path("weiwei.entity.movie");
}
</code></pre>
</div>

<p>为了使用客户端API，首先要使用 ClientBuilder 工厂方法新建一个 Client 实例。如下</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Client client = ClientBuilder.newClient();
</code></pre>
</div>

<p>定位到一个web资源，一旦声明了一个客户端实例，可以通过以下的方式定位到一个web资源。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>WebTarget webTarget = client.target("http://example/rest");
</code></pre>
</div>

<p>当定位到一个资源后，其指向了RESTful服务的根路径。下面需要识别WebTarget上的资源：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>WebTarget resourceWebTarget = webTarget.path("resource");
</code></pre>
</div>

<p>现在resourceWebTarget定位到的资源URI为”http://example.com/rest/resource”。注意，这里的每一个类都可以指定更多的参数，为了获得更多的详细信息，请阅读jersey的api文档。</p>

<p>一个完整的例子可以参考下面的代码：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public &lt;T&gt; T find_JSON(Class&lt;T&gt; responseType, String title) throws ClientErrorException {
    WebTarget resource = webTarget;
    resource = resource.path(java.text.MessageFormat.format("{0}", new Object[]{title}));
    return resource.request(javax.ws.rs.core.MediaType.APPLICATION_JSON).get(responseType);
}
</code></pre>
</div>

<p>这段代码的大概意思是通过一个变量String title来查找符合条件的json对象。最后返回资源使用的格式为：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>return resource.request("请求的MIME类型").get("对应GET方法，响应的类型");
</code></pre>
</div>

<h4 id="jersey">Jersey的声明与使用</h4>
<p>Jersey的声明与使用非常的简单，可以通过如下的代码实现</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private JSONObject initJSON(String movieName) throws Exception {
    NewJerseyClient movieClient = new NewJerseyClient();
    JSONObject jo = JSONObject.fromObject(movieClient.find_JSON(String.class, movieName));
    return jo;
}
</code></pre>
</div>

<p>这里将请求得到的数据转成了一个JSONObject对象。下面就可以使用JSONObejct API来解析该对象了。到这边，整个Jersey的入门文档就结束了。为了获得更多高级信息，可以参考Jersey的API文档。</p>
</article>
        </div>
    </div><!--#post-content-->

    <div id="ds-comment" class="container">
        <div class="ds-thread" data-thread-key="/posts/jersey-2.3-basic-post.html" data-title="Jersey2.11 快速入门指南"></div>
        <script>
            var duoshuoQuery = {short_name:"wwsun"};  
            (function() {  
                var ds = document.createElement('script');  
                ds.type = 'text/javascript';
                ds.async = true;  
                ds.src = 'http://static.duoshuo.com/embed.js';  
                ds.charset = 'UTF-8';  
                (document.getElementsByTagName('head')[0]
                || document.getElementsByTagName('body')[0]).appendChild(ds);  
            })();
        </script>
    </div><!--#ds-comment-->

    <footer id="colophon" class="site-footer" role="contentinfo">
    <div class="site-info container">
        <div class="row">
            <nav id="menu-social" class="social-icons">
                <ul id="menu-social-items" class="social-menu">
                    <li><a href="https://github.com/wwsun" title="Github" class="rss" target="_blank"><i class="social_icon fa fa-github"><span>Github</span></i></a></li>
                    <li><a href="http://weibo.com/234170023" title="Weibo" class="youtube" target="_blank"><i class="social_icon fa fa-weibo"><span>Weibo</span></i></a></li>
                    <li><a href="https://twitter.com/wsun38" title="Twitter" class="twitter" target="_blank"><i class="social_icon fa fa-twitter"><span>Twitter</span></i></a></li>
                    <li><a href="https://plus.google.com/u/0/101153267739962807712/posts" title="Google+" class="googleplus" target="_blank"><i class="social_icon fa fa-googleplus"><span>GooglePlus</span></i></a></li>
                    <li><a href="/about.html#wechatQr" title="Wechat" class="facebook" target="_blank"><i class="fa fa-weixin"><span>Wechat</span></i></a></li>
                </ul>
            </nav>
            <nav role="navigation" class="col-md-6">
                <ul id="menu-flat-footer" class="nav footer-nav clearfix">
                    <li><a href="http://weibo.com/swwol">Weibo</a></li>
                    <li><a href="https://github.com/wwsun">Github</a></li>
                    <li><a href="http://www.zhihu.com/people/wwsun">Zhihu</a></li>
                    <li><a href="http://www.youtube.com/user/bootstrapbayofficial">Lofter</a></li>
                    <li><a href="http://wwsun.github.io/">Blog</a></li>
                </ul>
            </nav>
            <div class="copyright col-md-6">
                <a href="http://wwsun.github.io/" title="Sparkling">Weiwei SUN</a> All rights reserved. Theme by 
                <a href="http://colorlib.com/" target="_blank">Colorlib</a> Powered by
                <a href="https://pages.github.com/" target="_blank">Github Pages</a> and <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
            </div>
        </div>
    </div>
    <!-- .site-info -->
    <div class="scroll-to-top"><i class="fa fa-angle-up"></i></div>
    <!-- .scroll-to-top -->
</footer><!-- #colophon -->



</body>

</html>